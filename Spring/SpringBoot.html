<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Spring Boot 공부</title>
    <link rel="stylesheet" href="./css/index.css" />
</head>
<body>
    <section id="intro">
        <header class="note_title">스프링 부트</header>
        <ul>
            <li>스프링 부트의 특징
                <pre>
                    ● 스프링을 편리하게 사용할 수 있도록 지원, 최근에는 기본으로 사용
                    ● 단독으로 실행할 수 있는 스프링 애플리케이션을 쉽게 생성
                    ● Tomcat 같은 웹 서버를 내장해서 별도의 웹 서버를 설치하지 않아도 됨
                    ● 손쉬운 빌드 구성을 위한 Starter 종속성 재공
                    ● 스프링 3rd path (외부) 라이브러리 자동 구성
                    ● 메트릭, 상태 확인, 외부 구성같은 프로덕션 준비 기능 제공
                    ● 관례에 의한 간결한 설정
                </pre>
            </li>
            <li>스프링 부트 설치하기
                <pre>
                    1. 이클립스 최상단의 Help 메뉴에서 Eclipse Marketplace 선택하기
                    2. STS (Spring Tool Suite)를 검색한 후에 해당 확장 모듈 설치하기
                </pre>
            </li>
            <li>스프링 부트 프로젝트 생성하기 - 1
                <pre>
                    1. 이클립스 최상단의 File 메뉴의 New 메뉴에서 Spring Starter Project 선택하기
                    2. Name 속성에 프로젝트명을 작성한 후에 해당 프로젝트에 맞게 기본 설정을 세팅한 다음에 Next를 누른다.
                        ● type : 프로젝트 관리도구를 Maven과 Gradle중 선택
                            ○ Maven
                            ○ Gradle
                        ● Packaging : 프로젝트 빌드시 패키지의 형식
                            ○ Jar
                            ○ War
                        ● Java Version : 사용할 Java의 Version 선택
                        ● Language : 사용할 프로그래밍 언어 선택
                            ○ Java
                            ○ Kotlin
                            ○ Groovy
                        ● Group : 프로젝트의 큰 틀 (예시 : com.example)
                        ● Java Version : 프로젝트의 최상위 패키지 (예시 : com.example.demo)
                    3. 프로젝트에 필요한 라이브러리(Dependency)항목들을 선택한 후에 Finish를 누른다.

                    ※ 기본적으로 선택해야 하는 라이브러리 항목
                        1. Web : @*Mapping 어노테이션때문에 필요
                        2. JDBC
                        3. ORM 계열
                        4. DBMS 계열
                    ※ 추천하는 라이브러리 항목
                        ● xxx
                        ● xxx
                        ● xxx
                </pre>
            </li>
            <li>스프링 부트 프로젝트 생성하기 - 2
                <pre>
                    ● start.spring.io로 이동하기
                    ● SNAPSHOT이나 M1은 아직 개발이 미완료된 버전
                    ● Dependencies에서 Spring Web 받기
                </pre>
            </li>
            <li>스프링 부트 설정하기
                <pre>
                    1. 스프링 부트 프로젝트 생성 완료
                    2. Spring Boot에선 기본적으로 JSP VIEW를 지원하지 않기 때문에 pom.xml에 dependency를 추가
                        &lt;dependency>
                            &lt;groupId>org.apache.tomcat.embed&lt;/groupId>
                            &lt;artifactId>tomcat-embed-jasper&lt;/artifactId>
                        &lt;/dependency>
                        &lt;dependency>
                            &lt;groupId>jstl&lt;/groupId>
                            &lt;artifactId>jstl&lt;/artifactId>
                            &lt;version>1.2&lt;/version>
                        &lt;/dependency>
                    3. application.properties에 가서 속성 추가
                        server.port=포트번호
    
                        spring.mvc.view.prefix=/WEB-INF/views/
                        spring.mvc.view.suffix=.jsp
                    4. src/main/java에 컨트롤러 패키지 및 클래스 생성
                    5. src/main에 webapp/WEB-INF/views 폴더 생성 후 해당 폴더에 jsp 파일 생성
                </pre>
            </li>
        </ul>
    </section>

    <br>

    <section id="validation">
        <header class="note_title">유효성 검증</header>
        <ul>
            <li>유효성 검증(validation)이란?
                <pre>
                    ● 오류를 방지하기 위해 미리 검증을 하는 과정
                </pre>
            </li>
            <li>유효성 검증에 대한 주의점
                <pre>
                    ● 검증해야 할 값이 많은 경우 코드의 길이가 길어진다.
                    ● 구현에 따라서 달라질 수도 있겠지만 Service Logic과의 분리가 필요하다.
                    ● 검증하는 코드가 흩어져 있는 경우 검증 위치가 불분명하며 재사용의 한계가 생긴다.
                    ● 구현 방식에 따라 다르겠지만 Validation Logic이 변경되면 참조하는 클래스에서 Logic이 변경되어야 하는 부분이 발생할 수 있다.
                    ● (중요 ★) 별로의 Logic이 필요한 어노테이션들 중에서 다른 VO 객체에서도 반복되는 내용이 있다면 아예 커스텀 어노테이션과 유효성 검증 클래스를 만드는 것이 낫다.
                </pre>
            </li>
            <li>필요 dependency
                <pre>
                    &lt;dependency>
                        &lt;groupId>org.springframework.boot&lt;/groupId>
                        &lt;artifactId>spring-boot-starter-validation&lt;/artifactId>
                    &lt;/dependency>
                </pre>
            </li>
            <li>유효성 검증 어노테이션
                <pre>
                    ● 길이 측정
                        ○ @Size(min="최솟값", max="최댓값") : 문자 길이 설정 : int Type 사용불가
                    ● null 또는 공백 여부 확인
                        ○ @NotNull : null 사용불가
                        ○ @NotEmpty : null & "" 사용불가
                        ○ @NotBlank : null & "" & " " 사용불가
                    ● 날짜 확인
                        ○ @Past : 과거 날짜
                        ○ @PastOrPresent : 과거 날짜 또는 오늘 날짜
                        ○ @Future : 미래 날짜
                        ○ @FutureOrPresent : 미래 날짜 또는 오늘 날짜
                    ● 데이터 차이 비교
                        ○ @Max(value="숫자") : 최댓값
                        ○ @Min(value="숫자") : 최솟값
                    ● 별도 Logic에 따른 유효성 검증
                        ○ @Pattern(regexp = "정규식") : 정규식 적용
                        ○ @AssertTure / @AssertFalse : 별도 Logic 적용
                        ○ @Valid : 해당 Object Validation 실행 (= 해당 어노테이션을 붙인 객체에 대해서 검사)
                    ● 형식
                        ○ @Email : 이메일 형식

                    ※ 공통 속성
                        ○ message : validation이 실패할 경우 반환되는 default 메세지
                        ○ payload : 특정 validation을 group을 지정하는 값
                        ○ groups : 사용자가 추가 정보를 위해 전달할 수 있는 값, 주로 심각도를 나타낼 때 사용
                </pre>
            </li>
            <li>사용 예시
                <pre>
                    ● @AssertTure(message="yyyyMMdd의 형식에 맞지 않습니다.")
                        private String birthday;
                        public String getBirthday() { return birthday; }
                        public void setBirthday(String birthday) { this.birthday = birthday; }
                        //boolean 형식 메소드명은 is로 시작해야 한다.
                        @AssertTrue
                        public boolean isBirthday(){
                            try {
                                LocalDate localDate = LocalDate.parse(getBirthday(), DateTimeFormatter.ofPattern("yyyyMMdd"));
                            } catch (Exception e) {
                                return false;
                            }
                            
                            return true;
                        }
                </pre>
            </li>
            <li>Custom Validator
                <pre>
                    1. validatior용 패키지를 만든다.
                    2. 해당 패키지에 유효성 검사용 자바 클래스를 만든다.
                    3. 해당 클래스에 ConstraintValidator 인터페이스를 구현한다.
                    4. ConstraintValidator에는 두 값이 필요한데 첫번째는 검증에 필요한 어노테이션의 종류고 두번째는 해당 어노테이션을 통해 들어올 값의 자료형이다.
                    5. initialize 메소드와 isValid 메소드를 오버라이딩한 다음에 필요한 코드를 작성한다.
                        ● initialize :
                            ○ 어노테이션 등록시 값을 초기화하는 메소드
                        ● isValid :
                            ○ 어노테이션 등록시 해당 값을 검증하는 메소드
                            ○ addConstraintViolation(ConstraintValidatorContext 변수, 전달할 메세지, "키 값"...)를 통해서 에러 메세지 전달 가능
                            ○ addConstraintViolation의 키 값들은 ErrorResponse의 errors[].field에 바인딩된다.
                    6. 해당 validatior를 사용할 어노테이션 파일에 가서 @Constraint 어노테이션의 validatedBy 속성의 {} 안에 추가해주면 된다.
                        예시) @Constraint(validatedBy = { BirthdayValidator.class })
                    7. 해당 validatior를 연결시킨 어노테이션을 필요한 곳에 추가해서 사용하면 된다.
                </pre>
            </li>
        </ul>
    </section>

    <br>

    <section id="exception">
        <header class="note_title">예외 처리</header>
        <ul>
            <li>예외처리 어노테이션
                <pre>
                    ● @ContrllerAdvice : Global 예외처리, 특정 패키지/컨트롤러 예외처리
                        ○ @ContrllerAdvice : @Contrller에 대해 사용하는 어노테이션
                        ○ @RestContrllerAdvice : @RestContrller에 대해 사용하는 어노테이션
                    ● @ExceptionHandler : 특정 컨트롤러의 예외처리
                </pre>
            </li>
            <li>@ExceptionHandler 기본 코드
                <pre>
                    @ExceptionHandler(value=예외종류.class)
                    public ResponseEntity exception(예외종류 e) {
                        //원하는 예외 클래스의 종류를 모를 때는 Exception e로 매개변수를 주고 e.getClass().getName()를 확인해보면 된다.
                        return ResponseEntity.status(HttpStatus.에러코드).body(e.getMessage());
                    }
                </pre>
            </li>
            <li>작동 방식
                <pre>
                    ● @ContrllerAdvice 어노테이션이 선언된 클래스 내부에 @ExceptionHandler가 선언된 메소드는 모든 컨트롤러에 대해서 적용된다.
                    ● @ContrllerAdvice 어노테이션이 모든 컨트롤러에 대해서 적용되긴 하지만
                      만약 @ContrllerAdvice가 있는 클래스에 있는 @ExceptionHandler와
                      개별의 컨트롤러에 있는 @ExceptionHandler가 같은 exception에 대해서 처리한다고 했을 때,
                      개별의 컨트롤러 쪽에 있는 @ExceptionHandler가 우선적용된다.
                </pre>
            </li>
        </ul>
    </section>

    <br>

    <section id="ObjectMapper">
        <header class="note_title">ObjectMapper</header>
        <ul>
            <li>xxx
                <pre>
                    ● xxx
                </pre>
            </li>
        </ul>
    </section>

    <br>

    <section id="responseEntity">
        <header class="note_title">ResponseEntity</header>
        <ul>
            <li>xxx
                <pre>
                    ● xxx
                </pre>
            </li>
        </ul>
    </section>

    <br>

    <section id="annotation">
        <header class="note_title">어노테이션 목록</header>
        <ul>
            <li>목록
                <pre>
                    ● @SpringBootApplication
                    ● @JsonProperty
                    ● @JsonNaming
                    ● @JsonInclude
                </pre>
            </li>
            <li>스프링 부트
                <pre>
                    ● @SpringBootApplication : 해당 클래스를 Spring Boot Application으로 설정
                </pre>
            </li>
            <li>컨트롤러 관련 어노테이션
                <pre>
                    ● @RestController
                        ○ 정의 : 해당 클래스를 REST API를 제공하는 컨트롤러로 설정
                        ○ 요약 : @Controller + @ResponseBody
                        ※ 주의점 :
                            @RestController를 붙이게 되면 해당 컨트롤러는 view 페이지를 반환하는게 아닌 응답본문 객체를 반환하는 것이기 때문에
                            Ajax같은 기능에 대한 메소드들이 모여있는 클래스에서 사용하는 것이 좋다.

                    ● @GetMapping : Http Get Method URL 주소 매핑
                    ● @PostMapping : Http Post Method URL 주소 매핑
                    ● @PutMapping : Http Put Method URL 주소 매핑
                    ● @DeleteMapping : Http Delete Method URL 주소 매핑

                    ● @Valid : POJO Java class의 검증
                </pre>
            </li>
            <li>Custom Annotation
                <pre>
                   1. 어노테이션용 패키지를 만든다.
                   2. 해당 패키지에서 어노테이션 파일을 만든다. (New에 보면 어노테이션이 있다.)
                   3. 어노테이션 제작 시 필요한 항목들을 선택해서 만들거나 아니면 아래의 기본적인 값들을 복사 및 붙여넣기 한다.
                        기초 import 목록 )
                            import static java.lang.annotation.ElementType.ANNOTATION_TYPE;
                            import static java.lang.annotation.ElementType.CONSTRUCTOR;
                            import static java.lang.annotation.ElementType.FIELD;
                            import static java.lang.annotation.ElementType.METHOD;
                            import static java.lang.annotation.ElementType.PARAMETER;
                            import static java.lang.annotation.ElementType.TYPE_USE;
                            import static java.lang.annotation.RetentionPolicy.RUNTIME;
                            
                            import java.lang.annotation.Documented;
                            import java.lang.annotation.Retention;
                            import java.lang.annotation.Target;
                            
                            import javax.validation.Constraint;
                            import javax.validation.Payload;
                        기초 어노테이션 목록 )
                            @Documented
                            @Constraint(validatedBy = { })
                            @Target({ METHOD, FIELD, ANNOTATION_TYPE, CONSTRUCTOR, PARAMETER, TYPE_USE })
                            @Retention(RUNTIME)
                        기초 속성 목록 )
                            String message() default "{javax.validation.constraints.Email.message}";
                            Class&lt;?>[] groups() default { };
                            Class&lt;? extends Payload>[] payload() default { };
                            String regexp() default ".*";
                </pre>
            </li>
        </ul>
    </section>

    <br>

    <section id="reference">
        <header class="note_title">참조 목록</header>
        <ul>
            <li>Talend API Tester
                <pre>
                    ● 요청에 대한 테스트를 진행할 수 있는 크롬 앱
                    ● 크롬 앱스토어에서 설치 가능
                    ● 비슷한 프로그램 : 포스트맨
                </pre>
            </li>
        </ul>
    </section>

    <br>

    <section id="xxx">
        <header class="note_title">xxx</header>
        <ul>
            <li>xxx
                <pre>
                    ● xxx
                </pre>
            </li>
        </ul>
    </section>

    <div id="remote">
        <section id="remote_setcion">
            <select id="remote_menu">
                <option value="intro">스프링 부트</option>
                <option value="validation">유효성 검사</option>
                <option value="exception">예외 처리</option>
                <option value="ObjectMapper">ObjectMapper</option>
                <option value="responseEntity">ResponseEntity</option>
                <option value="annotation">어노테이션 목록</option>
                <option value="reference">참조 목록</option>
            </select>
        </section>
    </div>

    <!-- 모달 영역 시작 -->
    <div id="xxx" class="modal">
        <div class="modal-content">
            <span class="close">&times;</span>
            <span class="modal_title">xxx</span>
            <div class="modal_content">
                <p style="margin-left: 30px;">
                    xxx
                </p>
            </div>
        </div>
    </div>
    <!-- 모달 영역 종료 -->

    <script src="./remote.js"></script>
</body>
</html>